
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non Parameter Testing &#8212; From Statistics to Statistical Learning</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://integzz.github.io/excss-stats/probability/16-Non-Parameter-Testing.html" />
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Survival Analysis" href="17-Survival-Analysis.html" />
    <link rel="prev" title="Parameter Testing" href="15-Parameter-Testing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">From Statistics to Statistical Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   From Statistics to Statistical Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  HandsON
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/02-data-processing.html">
   Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/04-linear-models.html">
   Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/05-support-vector-machines.html">
   Support Vector Machines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/06-decision-trees.html">
   Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/07-ensemble-learning.html">
   Ensemble Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/08-dimensionality-reduction.html">
   Dimensionality Reduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  HandsON DL
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../handson-dl/101-intro-keras.html">
   Introduction to Artificial Neural Networks with Keras
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson-dl/103-custom-models.html">
   Custom Models
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Probablity
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-Probability-and-Counting.html">
   Probability and Counting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-Conditional-Probability.html">
   Conditional Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Random-Variables-and-their-Distributions.html">
   Random Variables and their Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Expectation.html">
   Expectation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Continuous-Random-Variables.html">
   Continuous Random Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Moments.html">
   Moments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-Joint-Distributions.html">
   Joint Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-Transformations.html">
   Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-Conditional-Expectation.html">
   Conditional Expectation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10-Inequalities-and-Limit-Theorems.html">
   Inequalities and Limit Theorems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11-Markov-Chains.html">
   Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-Markov-Chain-Monte-Carlo.html">
   Markov Chain Monte Carlo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Poisson-Processes.html">
   Poisson Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-Sampling.html">
   Sampling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-Parameter-Testing.html">
   Parameter Testing
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Non Parameter Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-Survival-Analysis.html">
   Survival Analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/probability/16-Non-Parameter-Testing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/integzz/excss-stats/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/integzz/excss-stats//issues/new?title=Issue%20on%20page%20%2Fprobability/16-Non-Parameter-Testing.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/integzz/excss-stats/master?urlpath=lab/tree/probability/16-Non-Parameter-Testing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/integzz/excss-stats/blob/master/probability/16-Non-Parameter-Testing.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Non Parameter Testing
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chi-squared-goodness-of-fit-test">
   Chi-Squared Goodness-of-Fit Test
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-of-one-proportion">
   Analysis of one proportion
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chi-square-test-to-a-2x2-table">
   Chi-square test to a 2x2 table
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fisher-s-exact-test">
   Fisher’s Exact Test
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cochran-s-q-test">
   Cochran’s Q test
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mcnemar-test">
   McNemar test
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="non-parameter-testing">
<h1>Non Parameter Testing<a class="headerlink" href="#non-parameter-testing" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span><span class="p">,</span> <span class="n">special</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="chi-squared-goodness-of-fit-test">
<h1>Chi-Squared Goodness-of-Fit Test<a class="headerlink" href="#chi-squared-goodness-of-fit-test" title="Permalink to this headline">¶</a></h1>
<p>This is the last topic of the this tutorial session. Let’s walk through an example, then you will be able to grasp the essence of <strong>chi-squared goodness-of-fit test</strong>.</p>
<p>There are three marksman, who are competing shooting beer bottles hanging on a tree <span class="math notranslate nohighlight">\(300m\)</span> away, according to their historical records. Here is their hitting rates.</p>
<table style="width:30%; text-align:center;font-size: 120%">
  <tr>
    <th>Marksman</th>
    <th>Hitting Rate</th>
  </tr>
  <tr>
    <td>A</td>
    <td>24%</td>
  </tr>
  <tr>
    <td>B</td>
    <td>40%</td>
  </tr>
   <tr>
    <td>C</td>
    <td>36%</td>
  </tr>
</table><p>Apparently <span class="math notranslate nohighlight">\(24\%+40\%+36\%=1\)</span>, which is a feature of <strong>multinomial experiment</strong>.</p>
<p>In order to improve performance, Marksman A attended a hunter training camp, then they agree to compete again. They take turn to shoot and will stop until the 500th bottle is shot. Here is the result.</p>
<table style="width:30%; text-align:center;font-size: 120%">
  <tr>
    <th>Marksman</th>
    <th>Bottles</th>
  </tr>
  <tr>
    <td>A</td>
    <td>142</td>
  </tr>
  <tr>
    <td>B</td>
    <td>187</td>
  </tr>
   <tr>
    <td>C</td>
    <td>172</td>
  </tr>
</table><p>We would like to know if Marksman A has improved which also causes the hitting rate changes. The null hypothesis is specified as
$<span class="math notranslate nohighlight">\(
H_0: p_1=24\%, p_2 = 40\%, p_3=36\%\\
H_1: \text{At least one \)</span>p_i<span class="math notranslate nohighlight">\( is not equal to its specified value}
\)</span>$</p>
<p>Without seeing the lastest competition result, we are looking forward to the <strong>expected frequency</strong> to be
$<span class="math notranslate nohighlight">\(
e_1 = 500× 24\% = 120\\
e_2 = 500× 40\% = 200\\
e_3 = 500× 36\% = 180
\)</span>$</p>
<p>And here’s the comparison bar chart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Marksman 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Marksman 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Marksman 3&#39;</span><span class="p">]</span>
<span class="n">post_training</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">142</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">172</span><span class="p">])</span>
<span class="n">exp_frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">.2</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">rects1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">post_training</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post-Training&#39;</span><span class="p">)</span>
<span class="n">rects2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">exp_frequency</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exp. Freq.&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Scores&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scores of Exp. Freq. And Post-Training&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/16-Non-Parameter-Testing_9_0.png" src="../_images/16-Non-Parameter-Testing_9_0.png" />
</div>
</div>
<p>If the expected and observed frequencies differ significantly, we would conclude a rejection to the null hypothesis. The test statistic is
$<span class="math notranslate nohighlight">\(
χ^2=∑_{i=1}^k\frac{(f_i-e_i)^2}{e_i}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>f_i<span class="math notranslate nohighlight">\( and \)</span>e_i<span class="math notranslate nohighlight">\( are observed and expected frequencies. In this example, \)</span>χ^2<span class="math notranslate nohighlight">\( is
\)</span><span class="math notranslate nohighlight">\(
χ^2 = \frac{(f_1-e_1)^2}{e_1}+\frac{(f_2-e_2)^2}{e_2}+\frac{(f_3-e_3)^2}{e_3}
\)</span>$</p>
<p>Compute the <span class="math notranslate nohighlight">\(χ^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">((</span><span class="n">post_training</span> <span class="o">-</span> <span class="n">exp_frequency</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">exp_frequency</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.233888888888888
</pre></div>
</div>
</div>
</div>
<p>Degree of freedom is <span class="math notranslate nohighlight">\(ν=k-1=2\)</span>, therefore the rejection region is
$<span class="math notranslate nohighlight">\(
χ^2&gt;χ^2_{.05, 2}
\)</span>$
which can be found by <code class="docutils literal notranslate"><span class="pre">stats.chi2.ppf</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">.95</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.991464547107979
</pre></div>
</div>
</div>
</div>
<p>Because <span class="math notranslate nohighlight">\(χ^2\)</span>-statistic did not surpass the critical value, we conclude a fail to rejection of null hypothesis. That means even though the post-traning result is better than expectation, it’s likely to be a statistical fluke rather than evidence of skill improvement.</p>
</div>
<div class="section" id="analysis-of-one-proportion">
<h1>Analysis of one proportion<a class="headerlink" href="#analysis-of-one-proportion" title="Permalink to this headline">¶</a></h1>
<p>Calculate the confidence intervals of the population, based on a given data sample.</p>
<p><em>Suppose a general practitioner chooses a random sample of 215 women from
the patient register for her general practice, and finds that 39 of them
have a history of suffering from asthma. What is the confidence interval
for the prevalence of asthma?</em>  (The data are taken from Altman, chapter 10.2.1:)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the data</span>
<span class="n">numTotal</span> <span class="o">=</span> <span class="mi">215</span>
<span class="n">numPositive</span> <span class="o">=</span> <span class="mi">39</span>

<span class="c1"># Calculate the confidence intervals</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numPositive</span><span class="p">)</span><span class="o">/</span><span class="n">numTotal</span>
<span class="n">se</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">numTotal</span><span class="p">)</span>
<span class="n">td</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">numTotal</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">td</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mf">0.025</span><span class="p">)</span><span class="o">*</span><span class="n">se</span>

<span class="c1"># Print them</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ONE PROPORTION&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The confidence interval for the given sample is </span><span class="si">{0:5.3f}</span><span class="s1"> to </span><span class="si">{1:5.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ONE PROPORTION
The confidence interval for the given sample is 0.130 to 0.233
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="chi-square-test-to-a-2x2-table">
<h1>Chi-square test to a 2x2 table<a class="headerlink" href="#chi-square-test-to-a-2x2-table" title="Permalink to this headline">¶</a></h1>
<p>Data are taken from Altman, Table 10.10:</p>
<p><em>Comparison of number of hours swimming by swimmers with or without erosion of dental enamel:</em>
&gt;= 6h: 32 yes, 118 no
&lt;  6h: 17 yes, 127 no</p>
<p>The calculations are done with and without Yate’s continuity
correction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter the data</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">118</span><span class="p">],</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">127</span><span class="p">]])</span>

<span class="c1"># Calculate the chi-square test</span>
<span class="n">chi2_corrected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">correction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">chi2_uncorrected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">correction</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CHI SQUARE&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The corrected chi2 value is </span><span class="si">{0:5.3f}</span><span class="s1">, with p=</span><span class="si">{1:5.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2_corrected</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">chi2_corrected</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The uncorrected chi2 value is </span><span class="si">{0:5.3f}</span><span class="s1">, with p=</span><span class="si">{1:5.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chi2_uncorrected</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">chi2_uncorrected</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CHI SQUARE
The corrected chi2 value is 4.141, with p=0.042
The uncorrected chi2 value is 4.802, with p=0.028
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fisher-s-exact-test">
<h1>Fisher’s Exact Test<a class="headerlink" href="#fisher-s-exact-test" title="Permalink to this headline">¶</a></h1>
<p><em>Spectacle wearing among juvenile delinquensts and non-delinquents who failed a vision test</em></p>
<ul class="simple">
<li><p>Spectecle wearers: 1 delinquent, 5 non-delinquents</p></li>
<li><p>non-spectacle wearers: 8 delinquents, 2 non-delinquents’’’</p></li>
</ul>
<p>(Data are taken from Altman, Table 10.14)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter the data</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>

<span class="c1"># Calculate the Fisher Exact Test</span>
<span class="n">fisher_result</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The probability of obtaining a distribution at least as extreme &#39;</span>
<span class="o">+</span> <span class="s1">&#39;as the one that was actually observed, assuming that the null &#39;</span> <span class="o">+</span>
    <span class="s1">&#39;hypothesis is true, is: </span><span class="si">{0:5.3f}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fisher_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The probability of obtaining a distribution at least as extreme as the one that was actually observed, assuming that the null hypothesis is true, is: 0.035.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cochran-s-q-test">
<h1>Cochran’s Q test<a class="headerlink" href="#cochran-s-q-test" title="Permalink to this headline">¶</a></h1>
<p><em>12 subjects are asked to perform 3 tasks. The outcome of each task is “success” or
“failure”. The results are coded 0 for failure and 1 for success. In the example, subject 1 was successful
in task 2, but failed tasks 1 and 3. Is there a difference between the performance on the three tasks?</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.sandbox.stats.runs</span> <span class="kn">import</span> <span class="n">cochrans_q</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

<span class="c1"># I prefer a DataFrame here, as it indicates directly what the values mean</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tasks</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Task1&#39;</span><span class="p">,</span> <span class="s1">&#39;Task2&#39;</span><span class="p">,</span> <span class="s1">&#39;Task3&#39;</span><span class="p">])</span>

<span class="c1"># --- &gt;&gt;&gt; START stats &lt;&lt;&lt; ---</span>
<span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">pVal</span><span class="p">)</span> <span class="o">=</span> <span class="n">cochrans_q</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># --- &gt;&gt;&gt; STOP stats &lt;&lt;&lt; ---</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Q = </span><span class="si">{0:5.3f}</span><span class="s1">, p = </span><span class="si">{1:5.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">pVal</span><span class="p">))</span>
<span class="k">if</span> <span class="n">pVal</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is a significant difference between the three tasks.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q = 8.667, p = 0.013
There is a significant difference between the three tasks.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mcnemar-test">
<h1>McNemar test<a class="headerlink" href="#mcnemar-test" title="Permalink to this headline">¶</a></h1>
<p><em>McNemars Test should be run in the “exact” version, even though approximate formulas are
typically given in the lecture scripts. Just ignore the statistic that is returned, because
it is different for the two options.</em></p>
<p><em>In the following example, a researcher attempts to determine if a drug has an effect on a
particular disease. Counts of individuals are given in the table, with the diagnosis
(disease: present or absent) before treatment given in the rows, and the diagnosis
after treatment in the columns. The test requires the same subjects to be included in
the before-and-after measurements (matched pairs).</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.sandbox.stats.runs</span> <span class="kn">import</span> <span class="n">mcnemar</span>

<span class="n">f_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">],[</span><span class="mi">59</span><span class="p">,</span> <span class="mi">33</span><span class="p">]])</span>
<span class="p">(</span><span class="n">statistic</span><span class="p">,</span> <span class="n">pVal</span><span class="p">)</span> <span class="o">=</span> <span class="n">mcnemar</span><span class="p">(</span><span class="n">f_obs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p = </span><span class="si">{0:5.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pVal</span><span class="p">))</span>
<span class="k">if</span> <span class="n">pVal</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There was a significant change in the disease by the treatment.&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p = 4.434e-06
There was a significant change in the disease by the treatment.
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./probability"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="15-Parameter-Testing.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Parameter Testing</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="17-Survival-Analysis.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Survival Analysis</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By integzz<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>