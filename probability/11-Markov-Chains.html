
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 11: Markov Chains &#8212; From Statistics to Statistical Learning</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://integzz.github.io/excss-stats/probability/11-Markov-Chains.html" />
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 12: Markov Chain Monte Carlo" href="12-Markov-Chain-Monte-Carlo.html" />
    <link rel="prev" title="Chapter 10: Inequalities and Limit Theorems" href="10-Inequalities-and-Limit-Theorems.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">From Statistics to Statistical Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   From Statistics to Statistical Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  HandsON
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/02-data-processing.html">
   Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/03-classification.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/04-linear-models.html">
   Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/05-support-vector-machines.html">
   Support Vector Machines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/06-decision-trees.html">
   Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson/07-ensemble-learning.html">
   Ensemble Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  HandsON DL
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../handson-dl/101-intro-keras.html">
   Introduction to Artificial Neural Networks with Keras
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../handson-dl/103-custom-models.html">
   Custom Models
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Probablity
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01-Probability-and-Counting.html">
   Chapter 1: Probability and Counting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-Conditional-Probability.html">
   Chapter 2: Conditional Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-Random-Variables-and-their-Distributions.html">
   Chapter 3: Random Variables and their Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-Expectation.html">
   Chapter 4: Expectation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05-Continuous-Random-Variables.html">
   Chapter 5: Continuous Random Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06-Moments.html">
   Chapter 6: Moments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07-Joint-Distributions.html">
   Chapter 7: Joint Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08-Transformations.html">
   Chapter 8: Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09-Conditional-Expectation.html">
   Chapter 9: Conditional Expectation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10-Inequalities-and-Limit-Theorems.html">
   Chapter 10: Inequalities and Limit Theorems
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 11: Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12-Markov-Chain-Monte-Carlo.html">
   Chapter 12: Markov Chain Monte Carlo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13-Poisson-Processes.html">
   Chapter 13: Poisson Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14-Sampling.html">
   Sampling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15-Parameter-Testing.html">
   Parameter Estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-Non-Parameter-Testing.html">
   Non Parameter Testing
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/probability/11-Markov-Chains.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/integzz/excss-stats/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/integzz/excss-stats//issues/new?title=Issue%20on%20page%20%2Fprobability/11-Markov-Chains.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/integzz/excss-stats/master?urlpath=lab/tree/probability/11-Markov-Chains.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/integzz/excss-stats/blob/master/probability/11-Markov-Chains.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-calculations">
   Matrix calculations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gambler-s-ruin">
   Gambler’s ruin
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulating-from-a-finite-state-markov-chain">
   Simulating from a finite-state Markov chain
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="chapter-11-markov-chains">
<h1>Chapter 11: Markov Chains<a class="headerlink" href="#chapter-11-markov-chains" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="matrix-calculations">
<h2>Matrix calculations<a class="headerlink" href="#matrix-calculations" title="Permalink to this headline">¶</a></h2>
<p>Let’s do some calculations for the 4-state Markov chain in Example 11.1.5, as an example of working with transition matrices in Python/NumPy/SciPy. First, we need to specify the transition matrix <span class="math notranslate nohighlight">\(Q\)</span>. This is done with a 2-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>: we type in the entries of the matrix, row by row, as a long vector, and then we pass that to the <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html"><code class="docutils literal notranslate"><span class="pre">numpy.array</span></code></a> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">transition matrix Q has shape: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.33333333 0.33333333 0.33333333 0.        ]
 [0.         0.         0.5        0.5       ]
 [0.         1.         0.         0.        ]
 [0.5        0.         0.         0.5       ]]

transition matrix Q has shape: (4, 4)
</pre></div>
</div>
</div>
</div>
<p>To obtain higher order transition probabilities, we can multiply <span class="math notranslate nohighlight">\(Q\)</span> by itself repeatedly. Matrix multiplication in NumPy is supported by <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html"><code class="docutils literal notranslate"><span class="pre">numpy.dot</span></code></a> both as a NumPy function and as an object method on an instance of <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>; the matrix multiplication function <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html"><code class="docutils literal notranslate"><span class="pre">numpy.matmul</span></code></a>; and the relatively new <a class="reference external" href="https://docs.python.org/3/whatsnew/3.5.html#whatsnew-pep-465"><code class="docutils literal notranslate"><span class="pre">&#64;</span></code></a> infix operator. Using <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> makes the code cleaner, so this notebook will use <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>. So</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q2</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">Q</span> 
<span class="n">Q3</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">@</span> <span class="n">Q</span> 
<span class="n">Q4</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">@</span> <span class="n">Q2</span>
<span class="n">Q5</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">@</span> <span class="n">Q2</span>
</pre></div>
</div>
</div>
</div>
<p>produces <span class="math notranslate nohighlight">\(Q^2\)</span> through <span class="math notranslate nohighlight">\(Q^5\)</span>. If we want to know the probability of going from state 3 to state 4 in exactly 5 steps, we can extract the <span class="math notranslate nohighlight">\((3, 4)\)</span> entry of <span class="math notranslate nohighlight">\(Q^5\)</span>. However, please do not forget that arrays in Python are zero-indexed, so if we want the <span class="math notranslate nohighlight">\(i\)</span><sup>th</sup>, <span class="math notranslate nohighlight">\(j\)</span><sup>th</sup> entry of <span class="math notranslate nohighlight">\(Q^5\)</span>, we need to index using <span class="math notranslate nohighlight">\(i-1\)</span>, <span class="math notranslate nohighlight">\(j-1\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># indexing to obtain the (3,4) entry of Q5</span>
<span class="n">Q5</span><span class="p">[</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.22916666666666666
</pre></div>
</div>
</div>
</div>
<p>This gives 0.229, agreeing with the value 11/48 shown in Example 11.1.5.</p>
<p>To compute a power <span class="math notranslate nohighlight">\(Q^n\)</span> without directly doing repeated matrix multiplications, we can use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.fractional_matrix_power.html#scipy.linalg.fractional_matrix_power"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.fractional_matrix_power</span></code></a> function in the SciPy <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code></a> module. For example, <code class="docutils literal notranslate"><span class="pre">scipy.linalg.fractional_matrix_power(Q,</span> <span class="pre">42)</span></code> yields <span class="math notranslate nohighlight">\(Q^{42}\)</span>. By exploring the behavior of <span class="math notranslate nohighlight">\(Q^n\)</span> as <span class="math notranslate nohighlight">\(n\)</span> grows, we can see Theorem 11.3.6 in action (and get a sense of how long it takes for the chain to get very close to its stationary distribution). In particular, for <span class="math notranslate nohighlight">\(n\)</span> large each row of <span class="math notranslate nohighlight">\(Q^n\)</span> is approximately (0.214, 0.286, 0.214, 0.286), so this is approximately the stationary distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">fractional_matrix_power</span>

<span class="c1"># to learn more about scipy.linalg.fractional_matrix_power, un-comment out the following line</span>
<span class="c1">#print(fractional_matrix_power.__doc__)</span>

<span class="n">Q42</span> <span class="o">=</span> <span class="n">fractional_matrix_power</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Q42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.21428573 0.28571434 0.21428567 0.28571426]
 [0.21428581 0.28571476 0.21428534 0.28571409]
 [0.21428559 0.28571363 0.21428623 0.28571455]
 [0.21428571 0.28571426 0.21428573 0.2857143 ]]
</pre></div>
</div>
</div>
</div>
<p>Another way to obtain the stationary distribution numerically is to use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.eig.html"><code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig</span></code></a> function in the <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code> module to compute the eigenvalues and eigenvectors of the transpose of <span class="math notranslate nohighlight">\(Q\)</span>; then the eigenvector corresponding to the eigenvalue 1 can be selected and normalized so that the components sum to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eig</span>

<span class="c1"># to learn more about scipy.linalg.eig, un-comment out the following line</span>
<span class="c1">#print(eig.__doc__)</span>

<span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># any eigenvalues of 1?</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eigenvalues of Q.T:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eigvals</span><span class="p">))</span>

<span class="c1"># if so, take the corresponding eigenvector...</span>
<span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;first eigenvector of Q.T:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eigvec</span><span class="p">))</span>

<span class="c1"># and normalize to get the stationary distribution</span>
<span class="n">stat_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigvec</span> <span class="o">/</span> <span class="n">eigvec</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;approximated stationary distribution of Q</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat_dist</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eigenvalues of Q.T:
[ 1.        +0.j          0.2765877 +0.39374041j  0.2765877 -0.39374041j
 -0.71984207+0.j        ]

first eigenvector of Q.T:
[0.42426407+0.j 0.56568542+0.j 0.42426407+0.j 0.56568542+0.j]

approximated stationary distribution of Q
[0.21428571 0.28571429 0.21428571 0.28571429]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gambler-s-ruin">
<h2>Gambler’s ruin<a class="headerlink" href="#gambler-s-ruin" title="Permalink to this headline">¶</a></h2>
<p>To simulate from the gambler’s ruin chain, we start by deciding the total amount of money <span class="math notranslate nohighlight">\(N\)</span> between the two gamblers, the probability <span class="math notranslate nohighlight">\(p\)</span> of gambler <span class="math notranslate nohighlight">\(A\)</span> winning a given round, and the number of time periods <span class="math notranslate nohighlight">\(nsim\)</span> that we wish to simulate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">nsim</span> <span class="o">=</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we allocate an array of length <code class="docutils literal notranslate"><span class="pre">nsim</span></code> called <code class="docutils literal notranslate"><span class="pre">x</span></code>, which will store the values of the Markov chain. For the initial condition, we set the first entry of <code class="docutils literal notranslate"><span class="pre">x</span></code> equal to 5; this gives both gamblers $5 to start with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsim</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<p>Now we are ready to simulate the subsequent values of the Markov chain. This is achieved with the following block of code, which we will explain step by step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">267914296</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsim</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">N</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.5</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>            
</pre></div>
</div>
</div>
</div>
<p>The first line constitutes a for loop: <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(1,</span> <span class="pre">nsim):</span></code> means that all the code inside the for loop will be executed over and over, with the value of <code class="docutils literal notranslate"><span class="pre">i</span></code> set to 1, then set to 2, then set to 3, all the way until <code class="docutils literal notranslate"><span class="pre">i</span></code> reaches the value <code class="docutils literal notranslate"><span class="pre">nsim</span></code>. Each pass through the loop represents one step of the Markov chain.</p>
<p>Inside the for loop, we first check to see whether the chain is already at one of the endpoints, 0 or <code class="docutils literal notranslate"><span class="pre">N</span></code>; we do this with an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement. If the chain is already at 0 or <code class="docutils literal notranslate"><span class="pre">N</span></code>, then we set its new value equal to its previous value, since the chain is not allowed to escape 0 or <code class="docutils literal notranslate"><span class="pre">N</span></code>. Otherwise, if the chain is not at 0 or <code class="docutils literal notranslate"><span class="pre">N</span></code>, it is free to move left or right. We use the <code class="docutils literal notranslate"><span class="pre">numpy.random.choice</span></code> function to move to the right 1 unit or to the left 1 unit, with probabilities <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">1-p</span></code>, respectively.</p>
<p>To see what path was taken by the Markov chain during our simulation, we can plot the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> as a function of time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsim</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#fc4e2a&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nsim</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nsim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Markov Chain Simulation: Gambler</span><span class="se">\&#39;</span><span class="s1">s Ruin&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/11-Markov-Chains_19_0.png" src="../_images/11-Markov-Chains_19_0.png" />
</div>
</div>
<p>You should see a path that starts at 5 and bounces up and down before being absorbed into state 0 or state N.</p>
</div>
<div class="section" id="simulating-from-a-finite-state-markov-chain">
<h2>Simulating from a finite-state Markov chain<a class="headerlink" href="#simulating-from-a-finite-state-markov-chain" title="Permalink to this headline">¶</a></h2>
<p>With a few modifications, we can simulate from an arbitrary Markov chain on a finite state space. For concreteness, we will illustrate how to simulate from the 4-state Markov chain in Example 11.1.5.</p>
<p>As above, we can type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>to specify the transition matrix <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>Next, we choose the number of states and the number of time periods to simulate, we allocate space for the results of the simulation, and we choose initial conditions for the chain. In this example, <code class="docutils literal notranslate"><span class="pre">x[0]</span> <span class="pre">=</span> <span class="pre">numpy.random.choice(range(1,4+1),</span> <span class="pre">1)[0]</span></code> says the initial distribution of the chain is uniform over all states. States 1, 2, 3, 4 map to Python matrix row indices 0, 1, 2, 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">433494437</span><span class="p">)</span>

<span class="c1"># states: 1, 2, 3, 4</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nsim</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nsim</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For the simulation itself, we again use <code class="docutils literal notranslate"><span class="pre">numpy.random.choice</span></code> to choose a number from 1 to <code class="docutils literal notranslate"><span class="pre">M</span></code>. At time <code class="docutils literal notranslate"><span class="pre">i</span></code>, the chain was previously at state <code class="docutils literal notranslate"><span class="pre">x[i-1]</span></code>, so we must use row <code class="docutils literal notranslate"><span class="pre">x[i-1]</span></code> of the transition matrix to determine the probabilities of sampling <span class="math notranslate nohighlight">\(1, 2, \dots, M\)</span>. The notation <code class="docutils literal notranslate"><span class="pre">Q[x[i-1]</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">:]</span></code> denotes row <code class="docutils literal notranslate"><span class="pre">x[i-1]</span> <span class="pre">-</span> <span class="pre">1</span></code> of the matrix <span class="math notranslate nohighlight">\(Q\)</span> (but do not forget that with states 1, 2, 3, 4, indexing matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> needs to use 0, 1, 2, 3 since arrays/matrices in Python are zero-indexed, hence we need to decrement by 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">888</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsim</span><span class="p">):</span>
    <span class="n">prev_row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">Q</span><span class="p">[</span><span class="n">prev_row</span><span class="p">,</span> <span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Since we set <code class="docutils literal notranslate"><span class="pre">nsim</span></code> to a large number, it may be reasonable to believe that the chain is close to stationarity during the latter portion of the simulation. To check this, we eliminate the first half of the simulations to give the chain time to reach stationarity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># index of halfway point</span>
<span class="n">halfway</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nsim</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># slice array x keeping the latter half of x</span>
<span class="c1"># (starting from the halfway point)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="n">halfway</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>We then use <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.unique.html"><code class="docutils literal notranslate"><span class="pre">numpy.unique</span></code></a> to calculate the number of times the chain visited each state; dividing by <code class="docutils literal notranslate"><span class="pre">x.size</span></code> converts the counts into proportions. The result is an approximation to the stationary distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">stat_dist</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;approximation to stationary distribution of Q:</span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat_dist</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>approximation to stationary distribution of Q:
[0.2116 0.2846 0.2156 0.2882]
</pre></div>
</div>
</div>
</div>
<p>For comparison, the true stationary distribution of the chain is (3/14, 2/7, 3/14, 2/7) <span class="math notranslate nohighlight">\(\approx\)</span> (0.214, 0.286, 0.214, 0.286). Is this close to what you obtained empirically?</p>
<hr class="docutils" />
<p>Joseph K. Blitzstein and Jessica Hwang, Harvard University and Stanford University, © 2019 by Taylor and Francis Group, LLC</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./probability"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="10-Inequalities-and-Limit-Theorems.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Chapter 10: Inequalities and Limit Theorems</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="12-Markov-Chain-Monte-Carlo.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Chapter 12: Markov Chain Monte Carlo</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By integzz<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>